{% extends "base_dashboard.html" %}

{% block title %}Dashboard - NeuroScan{% endblock %}

{% block page_subtitle %}Dashboard Médecin{% endblock %}

{% block page_title %}Bienvenue, Dr. {{ doctor.first_name }}{% endblock %}

{% block page_description %}Accédez à vos outils d'analyse d'imagerie cérébrale et gérez vos patients.{% endblock %}

{% block content %}
    
    <!-- Chat médical avec Gemini -->
    <div class="dashboard-card clickable p-0 overflow-hidden hover:shadow-2xl transition-all duration-300 hover:scale-105 bg-gradient-to-br from-emerald-50 via-white to-teal-50 border-l-4 border-emerald-500 medical-ai-card" onclick="navigateTo('chat')">
        <div class="p-6">
            <div class="dashboard-card-header mb-4">
                <div class="dashboard-card-icon bg-gradient-to-br from-emerald-500 via-green-600 to-teal-600 shadow-xl medical-chat-icon">
                    <div class="icon-wrapper relative">
                        <i class="fas fa-comments text-white text-xl relative z-20 chat-bubble-animation"></i>
                        <div class="ai-network absolute inset-0 z-10">
                            <div class="network-node absolute top-2 left-3 w-1.5 h-1.5 bg-cyan-300 rounded-full opacity-70 animate-pulse"></div>
                            <div class="network-node absolute top-4 right-2 w-1 h-1 bg-blue-300 rounded-full opacity-60 animate-pulse" style="animation-delay: 0.3s;"></div>
                            <div class="network-node absolute bottom-2 left-2 w-1.5 h-1.5 bg-teal-300 rounded-full opacity-80 animate-pulse" style="animation-delay: 0.6s;"></div>
                            <div class="network-connection absolute top-3 left-4 w-6 h-0.5 bg-gradient-to-r from-cyan-300 to-transparent opacity-40 animate-pulse" style="animation-delay: 0.9s;"></div>
                        </div>
                        <div class="gemini-glow absolute inset-0 bg-gradient-to-br from-emerald-400/20 to-teal-500/20 rounded-full animate-pulse" style="animation-duration: 3s;"></div>
                        <div class="icon-secondary absolute -top-2 -right-2 w-6 h-6 bg-gradient-to-r from-cyan-400 to-blue-500 rounded-full flex items-center justify-center border-2 border-white shadow-lg">
                            <i class="fab fa-google text-white text-xs"></i>
                        </div>
                    </div>
                </div>
                <div>
                    <h3 class="dashboard-card-title text-xl font-bold bg-gradient-to-r from-emerald-700 to-teal-700 bg-clip-text text-transparent">
                        Chat Médical IA
                        <span class="inline-flex items-center ml-2 px-2 py-1 text-xs font-semibold text-emerald-800 bg-emerald-100 rounded-full pulse-glow">
                            <i class="fab fa-google mr-1"></i>
                            Gemini Pro
                        </span>
                    </h3>
                    <p class="dashboard-card-subtitle text-emerald-600 font-medium">Assistant neurologique intelligent</p>
                </div>
            </div>
            <div class="dashboard-card-content space-y-3">
                <p class="text-gray-700 text-sm leading-relaxed">
                    Consultez notre IA médicale avancée pour des questions neurologiques, l'interprétation d'examens et des recommandations cliniques personnalisées.
                </p>
                <div class="flex items-center space-x-4 text-xs text-gray-600">
                    <span class="flex items-center bg-emerald-50 px-2 py-1 rounded-full hover:bg-emerald-100 transition-colors">
                        <i class="fas fa-brain text-emerald-500 mr-1 brain-icon-mini"></i> Neurologie
                    </span>
                    <span class="flex items-center bg-teal-50 px-2 py-1 rounded-full hover:bg-teal-100 transition-colors">
                        <i class="fas fa-database text-teal-500 mr-1"></i> Historique
                    </span>
                    <span class="flex items-center bg-purple-50 px-2 py-1 rounded-full hover:bg-purple-100 transition-colors">
                        <i class="fas fa-shield-check text-purple-500 mr-1 security-pulse"></i> Sécurisé
                    </span>
                </div>
            </div>
        </div>
        <div class="h-1 bg-gradient-to-r from-emerald-500 via-teal-500 to-cyan-500 medical-chat-glow relative overflow-hidden">
            <div class="absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent translate-x-[-100%] animate-shimmer"></div>
        </div>
    </div>
<br>
<br>

<!-- Actions rapides -->
<div class="dashboard-grid cols-4 mb-8">
    <!-- Nouvelle analyse -->
    <div class="dashboard-card clickable p-0 overflow-hidden hover:shadow-2xl transition-all duration-300 hover:scale-105 bg-gradient-to-br from-blue-50 via-white to-indigo-50 border-l-4 border-blue-500 brain-analysis-card" onclick="navigateTo('new_analysis')">
        <div class="p-6">
            <div class="dashboard-card-header mb-4">
                <div class="dashboard-card-icon primary bg-gradient-to-br from-blue-600 via-indigo-600 to-purple-600 shadow-xl brain-icon">
                    <div class="icon-wrapper">
                        <i class="fas fa-brain text-white text-xl relative z-10 brain-pulse"></i>
                        <div class="icon-circle absolute inset-2 border-2 border-white/30 rounded-full animate-spin-slow"></div>
                        <div class="icon-secondary absolute -top-1 -right-1 w-5 h-5 bg-gradient-to-r from-amber-400 to-orange-500 rounded-full flex items-center justify-center">
                            <i class="fas fa-microscope text-white text-xs"></i>
                        </div>
                        <div class="neural-network absolute inset-0 opacity-20">
                            <div class="neural-dot absolute top-2 left-3 w-1 h-1 bg-white rounded-full animate-pulse"></div>
                            <div class="neural-dot absolute top-4 right-3 w-1 h-1 bg-white rounded-full animate-pulse" style="animation-delay: 0.5s;"></div>
                            <div class="neural-dot absolute bottom-3 left-2 w-1 h-1 bg-white rounded-full animate-pulse" style="animation-delay: 1s;"></div>
                        </div>
                    </div>
                </div>
                <div>
                    <h3 class="dashboard-card-title text-xl font-bold bg-gradient-to-r from-blue-700 to-indigo-700 bg-clip-text text-transparent">
                        Analyse CNN Avancée
                        <span class="inline-flex items-center ml-2 px-2 py-1 text-xs font-semibold text-blue-800 bg-blue-100 rounded-full">
                            <i class="fas fa-brain mr-1"></i>
                            99.7%
                        </span>
                    </h3>
                    <p class="dashboard-card-subtitle text-blue-600 font-medium">Modèle de deep learning entraîné</p>
                </div>
            </div>
            <div class="dashboard-card-content space-y-3">
                <p class="text-gray-700 text-sm leading-relaxed">
                    Intelligence artificielle de dernière génération pour l'analyse d'imagerie cérébrale avec précision exceptionnelle.
                </p>
               
            </div>
        </div>
        <div class="h-1 bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-500 brain-analysis-glow"></div>
    </div>

    <!-- Tableau de bord pro -->
    <div class="dashboard-card clickable p-6 stats-card" onclick="navigateTo('pro_dashboard')">
        <div class="dashboard-card-header">
            <div class="dashboard-card-icon success bg-gradient-to-br from-green-500 via-emerald-600 to-teal-600 shadow-xl">
                <div class="icon-wrapper">
                    <i class="fas fa-chart-line text-white text-xl relative z-10"></i>
                    <div class="chart-animation absolute inset-1">
                        <div class="chart-bar absolute bottom-1 left-2 w-1 bg-white/40 animate-grow-bar-1" style="height: 40%;"></div>
                        <div class="chart-bar absolute bottom-1 left-4 w-1 bg-white/40 animate-grow-bar-2" style="height: 60%;"></div>
                        <div class="chart-bar absolute bottom-1 right-4 w-1 bg-white/40 animate-grow-bar-3" style="height: 80%;"></div>
                        <div class="chart-bar absolute bottom-1 right-2 w-1 bg-white/40 animate-grow-bar-4" style="height: 50%;"></div>
                    </div>
                    <div class="icon-secondary absolute -top-1 -right-1 w-5 h-5 bg-gradient-to-r from-yellow-400 to-orange-500 rounded-full flex items-center justify-center">
                        <i class="fas fa-trending-up text-white text-xs"></i>
                    </div>
                </div>
            </div>
            <div>
                <h3 class="dashboard-card-title">Statistiques</h3>
                <p class="dashboard-card-subtitle">Analyses et tendances</p>
            </div>
        </div>
        <div class="dashboard-card-content">
            <p class="text-gray-600 text-sm">
                Consultez les statistiques détaillées de vos analyses et suivez les tendances diagnostiques.
            </p>
        </div>
    </div>

    <!-- Suivi patients -->
    <div class="dashboard-card clickable p-6 patients-card" onclick="navigateTo('patients_list')">
        <div class="dashboard-card-header">
            <div class="dashboard-card-icon purple bg-gradient-to-br from-purple-500 via-violet-600 to-indigo-600 shadow-xl">
                <div class="icon-wrapper">
                    <i class="fas fa-user-injured text-white text-xl relative z-10"></i>
                    <div class="patients-animation absolute inset-0">
                        <div class="patient-dot absolute top-2 left-2 w-2 h-2 bg-white/30 rounded-full animate-bounce"></div>
                        <div class="patient-dot absolute top-2 right-2 w-2 h-2 bg-white/30 rounded-full animate-bounce" style="animation-delay: 0.2s;"></div>
                        <div class="patient-dot absolute bottom-2 left-2 w-2 h-2 bg-white/30 rounded-full animate-bounce" style="animation-delay: 0.4s;"></div>
                        <div class="patient-dot absolute bottom-2 right-2 w-2 h-2 bg-white/30 rounded-full animate-bounce" style="animation-delay: 0.6s;"></div>
                    </div>
                    <div class="icon-secondary absolute -top-1 -right-1 w-5 h-5 bg-gradient-to-r from-pink-400 to-rose-500 rounded-full flex items-center justify-center">
                        <i class="fas fa-heartbeat text-white text-xs"></i>
                    </div>
                </div>
            </div>
            <div>
                <h3 class="dashboard-card-title">Mes Patients</h3>
                <p class="dashboard-card-subtitle">Suivi médical complet</p>
            </div>
        </div>
        <div class="dashboard-card-content">
            <p class="text-gray-600 text-sm">
                Accédez à la liste complète de vos patients avec historique médical et évolution détaillée.
            </p>
        </div>
    </div>

    <!-- Gestion patients -->
    <div class="dashboard-card clickable p-6 management-card" onclick="navigateTo('manage_patients_page')">
        <div class="dashboard-card-header">
            <div class="dashboard-card-icon success bg-gradient-to-br from-teal-500 via-cyan-600 to-blue-600 shadow-xl">
                <div class="icon-wrapper">
                    <i class="fas fa-user-cog text-white text-xl relative z-10"></i>
                    <div class="gear-animation absolute inset-2 border border-white/20 rounded-full">
                        <div class="gear-inner absolute inset-1 border border-white/30 rounded-full animate-spin-reverse"></div>
                    </div>
                    <div class="icon-secondary absolute -top-1 -right-1 w-5 h-5 bg-gradient-to-r from-green-400 to-emerald-500 rounded-full flex items-center justify-center">
                        <i class="fas fa-plus text-white text-xs"></i>
                    </div>
                </div>
            </div>
            <div>
                <h3 class="dashboard-card-title">Gestion Patients</h3>
                <p class="dashboard-card-subtitle">Administration complète</p>
            </div>
        </div>
        <div class="dashboard-card-content">
            <p class="text-gray-600 text-sm">
                Ajouter, modifier, supprimer et gérer toutes les informations médicales de vos patients.
            </p>
        </div>
    </div>

    <!-- Statistiques plateforme -->
    <div class="dashboard-card clickable p-6 platform-card" onclick="navigateTo('platform_stats')">
        <div class="dashboard-card-header">
            <div class="dashboard-card-icon indigo bg-gradient-to-br from-indigo-500 via-blue-600 to-cyan-600 shadow-xl">
                <div class="icon-wrapper">
                    <i class="fas fa-globe-americas text-white text-xl relative z-10"></i>
                    <div class="globe-animation absolute inset-0 opacity-30">
                        <div class="orbit absolute inset-2 border border-white/20 rounded-full animate-spin"></div>
                        <div class="orbit absolute inset-3 border border-white/15 rounded-full animate-spin-reverse" style="animation-duration: 3s;"></div>
                        <div class="satellite absolute top-1 left-1/2 w-1 h-1 bg-white rounded-full animate-ping"></div>
                    </div>
                    <div class="icon-secondary absolute -top-1 -right-1 w-5 h-5 bg-gradient-to-r from-violet-400 to-purple-500 rounded-full flex items-center justify-center">
                        <i class="fas fa-network-wired text-white text-xs"></i>
                    </div>
                </div>
            </div>
            <div>
                <h3 class="dashboard-card-title">Stats Plateforme</h3>
                <p class="dashboard-card-subtitle">Vue d'ensemble globale</p>
            </div>
        </div>
        <div class="dashboard-card-content">
            <p class="text-gray-600 text-sm">
                Consultez les statistiques générales de tous les médecins utilisant la plateforme NeuroScan.
            </p>
        </div>
    </div>
</div>

<!-- Informations du compte -->
<div class="dashboard-card p-6 mb-8 account-info-card">
    <div class="dashboard-card-header">
        <div class="dashboard-card-icon primary bg-gradient-to-br from-slate-600 via-gray-700 to-zinc-700 shadow-xl">
            <div class="icon-wrapper">
                <i class="fas fa-user-md text-white text-xl relative z-10"></i>
                <div class="medical-cross absolute inset-3 opacity-30">
                    <div class="cross-vertical absolute left-1/2 top-0 bottom-0 w-0.5 bg-white transform -translate-x-1/2"></div>
                    <div class="cross-horizontal absolute top-1/2 left-0 right-0 h-0.5 bg-white transform -translate-y-1/2"></div>
                </div>
                <div class="icon-secondary absolute -top-1 -right-1 w-5 h-5 bg-gradient-to-r from-emerald-400 to-green-500 rounded-full flex items-center justify-center">
                    <i class="fas fa-check text-white text-xs"></i>
                </div>
            </div>
        </div>
        <div>
            <h3 class="dashboard-card-title">Informations du compte</h3>
            <p class="dashboard-card-subtitle">Vos données professionnelles</p>
        </div>
    </div>
    <div class="dashboard-card-content">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div class="space-y-4">
                <div>
                    <label class="form-label flex items-center">
                        <i class="fas fa-user text-blue-500 mr-2"></i>
                        Nom complet
                    </label>
                    <div class="p-3 bg-gradient-to-r from-gray-50 to-slate-50 rounded-lg border-l-4 border-blue-500">
                        <p class="text-gray-900 font-medium">Dr. {{ doctor.first_name }} {{ doctor.last_name }}</p>
                    </div>
                </div>
                <div>
                    <label class="form-label flex items-center">
                        <i class="fas fa-envelope text-green-500 mr-2"></i>
                        Email
                    </label>
                    <div class="p-3 bg-gradient-to-r from-gray-50 to-slate-50 rounded-lg border-l-4 border-green-500">
                        <p class="text-gray-900">{{ doctor.email }}</p>
                    </div>
                </div>
                <div>
                    <label class="form-label flex items-center">
                        <i class="fas fa-stethoscope text-purple-500 mr-2"></i>
                        Spécialité
                    </label>
                    <div class="p-3 bg-gradient-to-r from-gray-50 to-slate-50 rounded-lg border-l-4 border-purple-500">
                        <p class="text-gray-900">{{ doctor.specialty or 'Non spécifiée' }}</p>
                    </div>
                </div>
            </div>
            <div class="space-y-4">
                <div>
                    <label class="form-label flex items-center">
                        <i class="fas fa-hospital text-teal-500 mr-2"></i>
                        Établissement
                    </label>
                    <div class="p-3 bg-gradient-to-r from-gray-50 to-slate-50 rounded-lg border-l-4 border-teal-500">
                        <p class="text-gray-900">{{ doctor.hospital or 'Non spécifié' }}</p>
                    </div>
                </div>
                <div>
                    <label class="form-label flex items-center">
                        <i class="fas fa-id-card text-orange-500 mr-2"></i>
                        Numéro RPPS/ADELI
                    </label>
                    <div class="p-3 bg-gradient-to-r from-gray-50 to-slate-50 rounded-lg border-l-4 border-orange-500">
                        <p class="text-gray-900">{{ doctor.license_number or 'Non renseigné' }}</p>
                    </div>
                </div>
                <div>
                    <label class="form-label flex items-center">
                        <i class="fas fa-shield-check text-emerald-500 mr-2"></i>
                        Statut du compte
                    </label>
                    <div class="p-3 bg-gradient-to-r from-gray-50 to-slate-50 rounded-lg border-l-4 border-emerald-500">
                        <span class="badge success flex items-center">
                            <i class="fas fa-check-circle mr-1"></i>
                            <span class="animate-pulse">Compte Actif</span>
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Aide et support -->
<div class="dashboard-card p-6 bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50 border-blue-200 help-support-card">
    <div class="dashboard-card-header">
        <div class="dashboard-card-icon primary bg-gradient-to-br from-blue-500 via-indigo-600 to-purple-600 shadow-xl">
            <div class="icon-wrapper">
                <i class="fas fa-life-ring text-white text-xl relative z-10"></i>
                <div class="help-animation absolute inset-2">
                    <div class="help-ring absolute inset-0 border-2 border-white/20 rounded-full animate-ping"></div>
                    <div class="help-ring absolute inset-1 border border-white/30 rounded-full animate-pulse"></div>
                </div>
                <div class="icon-secondary absolute -top-1 -right-1 w-5 h-5 bg-gradient-to-r from-yellow-400 to-amber-500 rounded-full flex items-center justify-center">
                    <i class="fas fa-question text-white text-xs"></i>
                </div>
            </div>
        </div>
        <div class="flex-1">
            <h3 class="dashboard-card-title text-blue-900 flex items-center">
                Besoin d'aide ?
                <span class="ml-2 inline-flex items-center px-2 py-1 text-xs font-semibold text-blue-800 bg-blue-100 rounded-full">
                    <i class="fas fa-clock mr-1"></i>
                    24/7
                </span>
            </h3>
            <p class="dashboard-card-subtitle text-blue-700">
                Notre équipe est là pour vous accompagner dans l'utilisation de NeuroScan.
            </p>
        </div>
    </div>
    <div class="dashboard-card-content">
        <div class="flex flex-wrap gap-3">
            <button onclick="openUserGuideModal()" class="btn-dashboard primary enhanced-btn">
                <i class="fas fa-graduation-cap"></i>
                <span class="button-text">
                    Guide d'utilisation
                    <small class="block text-xs opacity-80">Apprenez les bases</small>
                </span>
            </button>
            <button onclick="openSupportModal()" class="btn-dashboard secondary enhanced-btn">
                <i class="fas fa-headset"></i>
                <span class="button-text">
                    Contacter le support
                    <small class="block text-xs opacity-80">Aide technique</small>
                </span>
            </button>
            <a href="tel:+213783962348" class="btn-dashboard success enhanced-btn">
                <i class="fas fa-phone-alt"></i>
                <span class="button-text">
                    Appel direct
                    <small class="block text-xs opacity-80">+213 783 962 348</small>
                </span>
            </a>
        </div>
    </div>
</div>

<!-- Modales spécifiques -->

<!-- Modal Guide d'utilisation -->
<div id="userGuideModal" class="modal-overlay hidden">
    <div class="modal-content" style="--modal-width: 900px;">
        <div class="modal-header">
            <h2 class="modal-title">
                <i class="fas fa-book text-neuroscan-600"></i>
                Guide d'utilisation NeuroScan
            </h2>
            <button onclick="closeUserGuideModal()" class="modal-close">
                <i class="fas fa-times text-xl"></i>
            </button>
        </div>
        <div class="modal-body">
            <div class="space-y-8">
                <!-- Section 1: Démarrage -->
                <div class="border-l-4 border-neuroscan-500 pl-6">
                    <h3 class="text-xl font-semibold text-gray-900 mb-4">
                        <i class="fas fa-play-circle text-neuroscan-600 mr-2"></i>1. Démarrage rapide
                    </h3>
                    <div class="space-y-3 text-gray-700">
                        <p><strong>Connexion :</strong> Utilisez vos identifiants médicaux pour accéder à votre tableau de bord personnalisé.</p>
                        <p><strong>Navigation :</strong> Le menu principal vous donne accès à toutes les fonctionnalités de NeuroScan.</p>
                    </div>
                </div>

                <!-- Section 2: Analyse d'images -->
                <div class="border-l-4 border-green-500 pl-6">
                    <h3 class="text-xl font-semibold text-gray-900 mb-4">
                        <i class="fas fa-brain text-green-600 mr-2"></i>2. Analyse d'images IRM
                    </h3>
                    <div class="space-y-3 text-gray-700">
                        <p><strong>Formats supportés :</strong> JPEG, PNG, DICOM (recommandé pour les IRM)</p>
                        <p><strong>Processus :</strong></p>
                        <ol class="list-decimal list-inside ml-4 space-y-1">
                            <li>Cliquez sur "Nouvelle Analyse" depuis le tableau de bord</li>
                            <li>Sélectionnez votre fichier IRM (glisser-déposer ou parcourir)</li>
                            <li>Renseignez les informations patient (optionnel mais recommandé)</li>
                            <li>Lancez l'analyse en cliquant sur "Analyser"</li>
                            <li>Consultez les résultats détaillés avec probabilités et recommandations</li>
                        </ol>
                    </div>
                </div>

                <!-- Section 3: Gestion des patients -->
                <div class="border-l-4 border-purple-500 pl-6">
                    <h3 class="text-xl font-semibold text-gray-900 mb-4">
                        <i class="fas fa-users text-purple-600 mr-2"></i>3. Gestion des patients
                    </h3>
                    <div class="space-y-3 text-gray-700">
                        <p><strong>Ajouter un patient :</strong> Utilisez "Gestion Patients" pour créer des fiches complètes</p>
                        <p><strong>Suivi longitudinal :</strong> Consultez l'évolution des patients dans "Mes Patients"</p>
                        <p><strong>Historique :</strong> Toutes les analyses sont automatiquement liées au dossier patient</p>
                    </div>
                </div>

                <!-- Section 4: Interprétation des résultats -->
                <div class="border-l-4 border-orange-500 pl-6">
                    <h3 class="text-xl font-semibold text-gray-900 mb-4">
                        <i class="fas fa-chart-line text-orange-600 mr-2"></i>4. Interprétation des résultats
                    </h3>
                    <div class="space-y-3 text-gray-700">
                        <p><strong>Classes de diagnostic :</strong></p>
                        <ul class="list-disc list-inside ml-4 space-y-1">
                            <li><span class="text-green-600 font-semibold">Pas de tumeur :</span> Tissu cérébral normal</li>
                            <li><span class="text-blue-600 font-semibold">Méningiome :</span> Tumeur généralement bénigne</li>
                            <li><span class="text-yellow-600 font-semibold">Adénome hypophysaire :</span> Tumeur de l'hypophyse</li>
                            <li><span class="text-red-600 font-semibold">Gliome :</span> Tumeur du tissu glial, nécessite attention</li>
                        </ul>
                        <p><strong>Niveau de confiance :</strong> Indique la certitude du modèle IA (>90% = très fiable)</p>
                    </div>
                </div>

                <!-- Section 5: Bonnes pratiques -->
                <div class="border-l-4 border-red-500 pl-6">
                    <h3 class="text-xl font-semibold text-gray-900 mb-4">
                        <i class="fas fa-exclamation-triangle text-red-600 mr-2"></i>5. Bonnes pratiques et limitations
                    </h3>
                    <div class="space-y-3 text-gray-700">
                        <p><strong>⚠️ Important :</strong> NeuroScan est un outil d'aide au diagnostic, pas un remplacement du jugement médical</p>
                        <p><strong>Qualité d'image :</strong> Utilisez des IRM de haute qualité pour de meilleurs résultats</p>
                        <p><strong>Validation :</strong> Toujours corréler avec l'examen clinique et d'autres examens</p>
                        <p><strong>Confidentialité :</strong> Toutes les données sont chiffrées et sécurisées</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <p class="text-sm text-gray-600">
                <i class="fas fa-info-circle mr-1"></i>
                Pour plus d'informations, contactez notre support technique
            </p>
            <button onclick="closeUserGuideModal()" class="btn-dashboard primary">
                Fermer
            </button>
        </div>
    </div>
</div>

<!-- Modal Support -->
<div id="supportModal" class="modal-overlay hidden">
    <div class="modal-content" style="--modal-width: 700px;">
        <div class="modal-header">
            <h2 class="modal-title">
                <i class="fas fa-headset text-green-600"></i>
                Contacter le Support
            </h2>
            <button onclick="closeSupportModal()" class="modal-close">
                <i class="fas fa-times text-xl"></i>
            </button>
        </div>
        <div class="modal-body">
            <div class="space-y-6">
                <!-- Informations de contact -->
                <div class="dashboard-card p-4 bg-green-50 border-green-200">
                    <h3 class="text-lg font-semibold text-green-900 mb-3">
                        <i class="fas fa-user-tie mr-2"></i>Support Technique NeuroScan
                    </h3>
                    <div class="space-y-3">
                        <div class="flex items-center">
                            <i class="fas fa-envelope text-green-600 w-5 mr-3"></i>
                            <div>
                                <p class="font-medium text-gray-900">Email</p>
                                <a href="mailto:mohammed.betkaoui@univ-bba.dz" class="text-green-600 hover:text-green-800 underline">
                                    mohammed.betkaoui@univ-bba.dz
                                </a>
                            </div>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-phone text-green-600 w-5 mr-3"></i>
                            <div>
                                <p class="font-medium text-gray-900">Téléphone</p>
                                <a href="tel:+213783962348" class="text-green-600 hover:text-green-800 underline">
                                    +213 783 962 348
                                </a>
                            </div>
                        </div>
                        <div class="flex items-center">
                            <i class="fas fa-clock text-green-600 w-5 mr-3"></i>
                            <div>
                                <p class="font-medium text-gray-900">Horaires</p>
                                <p class="text-gray-700">Lundi - Vendredi : 8h00 - 18h00</p>
                                <p class="text-gray-700">Urgences : 24h/24</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Types de support -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="dashboard-card p-4">
                        <h4 class="font-semibold text-gray-900 mb-2">
                            <i class="fas fa-cogs text-neuroscan-600 mr-2"></i>Support Technique
                        </h4>
                        <ul class="text-sm text-gray-700 space-y-1">
                            <li>• Problèmes de connexion</li>
                            <li>• Erreurs d'analyse</li>
                            <li>• Questions techniques</li>
                        </ul>
                    </div>
                    <div class="dashboard-card p-4">
                        <h4 class="font-semibold text-gray-900 mb-2">
                            <i class="fas fa-graduation-cap text-purple-600 mr-2"></i>Formation
                        </h4>
                        <ul class="text-sm text-gray-700 space-y-1">
                            <li>• Utilisation de la plateforme</li>
                            <li>• Interprétation des résultats</li>
                            <li>• Bonnes pratiques</li>
                        </ul>
                    </div>
                </div>

                <!-- Formulaire de contact rapide -->
                <div class="dashboard-card p-4">
                    <h4 class="font-semibold text-gray-900 mb-3">
                        <i class="fas fa-paper-plane text-neuroscan-600 mr-2"></i>Message rapide
                    </h4>
                    <form id="supportForm" class="space-y-3">
                        <div class="form-group">
                            <label class="form-label">Sujet</label>
                            <select class="form-select">
                                <option>Support technique</option>
                                <option>Question sur l'interprétation</option>
                                <option>Demande de formation</option>
                                <option>Autre</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Message</label>
                            <textarea class="form-textarea" placeholder="Décrivez votre demande..."></textarea>
                        </div>
                        <button type="button" onclick="sendSupportMessage()" class="btn-dashboard success w-full justify-center">
                            <i class="fas fa-envelope"></i>
                            Envoyer par email
                        </button>
                    </form>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <p class="text-sm text-gray-600">
                <i class="fas fa-shield-alt mr-1"></i>
                Toutes les communications sont sécurisées et confidentielles
            </p>
            <button onclick="closeSupportModal()" class="btn-dashboard secondary">
                Fermer
            </button>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
    // Navigation helper function
    function navigateTo(routeName) {
        const routes = {
            'pro_dashboard': '{{ url_for("pro_dashboard") }}',
            'patients_list': '{{ url_for("patients_list") }}',
            'manage_patients_page': '{{ url_for("manage_patients_page") }}',
            'platform_stats': '{{ url_for("platform_stats") }}',
            'new_analysis': '{{ url_for("new_analysis_page") }}',
            'chat': '{{ url_for("chat_page") }}',
            'medical_alerts': '{{ url_for("alerts_page") }}'
        };
        
        if (routes[routeName]) {
            // Ouvrir le chat médical dans une nouvelle fenêtre/onglet
            if (routeName === 'chat') {
                window.open(routes[routeName], '_blank', 'width=1400,height=900,scrollbars=yes,resizable=yes,toolbar=no,menubar=no');
            } else {
                window.location.href = routes[routeName];
            }
        }
    }

    // Fonctions spécifiques au dashboard

    function openUserGuideModal() {
        document.getElementById('userGuideModal').classList.remove('hidden');
        document.body.style.overflow = 'hidden';
    }

    function closeUserGuideModal() {
        document.getElementById('userGuideModal').classList.add('hidden');
        document.body.style.overflow = 'auto';
    }

    function openSupportModal() {
        document.getElementById('supportModal').classList.remove('hidden');
        document.body.style.overflow = 'hidden';
    }

    function closeSupportModal() {
        document.getElementById('supportModal').classList.add('hidden');
        document.body.style.overflow = 'auto';
    }

    function sendSupportMessage() {
        const form = document.getElementById('supportForm');
        const subject = form.querySelector('select').value;
        const message = form.querySelector('textarea').value;

        if (!message.trim()) {
            showNotification('Veuillez saisir votre message', 'warning');
            return;
        }

        // Créer le lien mailto avec les informations
        const emailBody = `Sujet: ${subject}\n\nMessage:\n${message}\n\n---\nEnvoyé depuis NeuroScan Dashboard\nMédecin: Dr. ${currentDoctor.name}\nEmail: ${currentDoctor.email}`;
        const mailtoLink = `mailto:mohammed.betkaoui@univ-bba.dz?subject=Support NeuroScan - ${subject}&body=${encodeURIComponent(emailBody)}`;

        // Ouvrir le client email
        window.location.href = mailtoLink;

        // Fermer le modal après un court délai
        setTimeout(() => {
            closeSupportModal();
            // Réinitialiser le formulaire
            form.querySelector('textarea').value = '';
            showNotification('Email de support ouvert dans votre client de messagerie', 'success');
        }, 1000);
    }
</script>
{% endblock %}
